<html>
    <head>
        <title>Cloud Stuff</title>
        <script src="https://cdn.jsdelivr.net/npm/comfy.js@latest/dist/comfy.min.js"></script>
        <script src="https://cdn.jsdelivr.net/npm/comfytwitch@latest/web/comfytwitch.min.js"></script>
        <script src="secret.js"></script>
        <script src="cloudbot.js"></script>
        <style>
            body, h1, p {
                color: black;
                font-size: 50px;
                background-color: whitesmoke;
                }

            table {
                font-size: 50px;
            }

            th {
                font-weight: bold;
                border: 1px solid #cccccc; /* Change the border-color of heading here */
                padding: 8px;
            }

            td {
                border: 1px solid #cccccc; /* Change the border-color of cells here */
                padding: 8px;
            }

        </style>
    </head>
    <body>

        <h1 id="fbTrace"></h1>
        <p id="lastChatMsg"></p>
        <div id="imageViewer"></div>
        
        <script type="text/javascript">

            let scoreskeeper = [];

            ComfyJS.onCommand = async ( user, command, message, flags, extra ) => {
                if( command === "test" ) {
                    test(message);
                }
                else if( flags.broadcaster && command === "talk" ) {
                    ChatBotSay();
                }
                else if( flags.broadcaster && command === "cloud" ) {
                    cloud();
                }
                else if( flags.broadcaster && command === "clean" ) {
                    console.log( "!clean was typed in chat" );
                    clean();
                }
                else if( command === "az" ) {
                    console.log( "!az was typed in chat" );
                    testAzFunc(message, updateTrace);
                }
                else if( flags.broadcaster && command === "scores" ) 
                {
                    scores();
                }
                else if( command === "stats" ) 
                {
                    console.log( "!stats was typed in chat" );
                    StatsFor(user);
                }
            }

            ComfyJS.onChat = ( user, message, flags, self, extra ) => {
               
                console.log(
                    `new incoming...`
                );   

                if( flags.broadcaster) {
                    console.log( "Frank message" );
                    ParseMessage(message);
                }
                
                document.querySelector("#lastChatMsg").innerText = message; 
            }

            //
            // Define a const authToken in secret.js get the token at
            // https://twitchapps.com/tmi/
            //

            ComfyJS.Init( "fboucheros", authToken );
          </script>
    </body>
</html>
